var documenterSearchIndex = {"docs":
[{"location":"generated/examples/01-spline/#01-spline","page":"Spline grid fitting","title":"Spline grid fitting","text":"This page illustrates finite-series modeling with splines with the intention of comparing to INR.\n\nURL.\n\nThis page was generated from a single Julia file: 01-spline.jl.\n\nIn any such Julia documentation, you can access the source code using the \"Edit on GitHub\" link in the top right.\n\nThe corresponding notebook can be viewed in nbviewer here: 01-spline.ipynb, and opened in binder here: 01-spline.ipynb.","category":"section"},{"location":"generated/examples/01-spline/#Setup","page":"Spline grid fitting","title":"Setup","text":"Packages needed here.\n\nusing BSplineKit\nusing LinearAlgebra: I, norm\nusing MIRTjim: jim, prompt\nusing InteractiveUtils: versioninfo\nusing Plots\nusing Random: seed!\ndefault(markerstrokecolor=:auto, label=\"\")\nseed!(0)\n\nThe following line is helpful when running this file as a script; this way it will prompt user to hit a key after each figure is displayed.\n\nisinteractive() ? jim(:prompt, true) : prompt(:draw);\nnothing #hide","category":"section"},{"location":"generated/examples/01-spline/#Data","page":"Spline grid fitting","title":"Data","text":"N = 100\ntmax = 3\nt = tmax * sort(rand(N)) # random samples on [0,3]\nf(t) = 1 < t < 2 # rect function\ny = f.(t); # noiseless data for now\nnothing #hide\n\nplot data and true signal (finely sampled)\n\nyaxis = ((-0.2, 1.4), -0.2:0.2:1.4)\ntf = range(-0.3, tmax+0.3, 1001) # fine grid\nytf = f.(tf) # true function on a fine grid\np0 = scatter(t, y; yaxis, color=:black, label=\"data\")\nplot!(p0, tf, ytf, label=\"true\")\n\nB-spline settings\n\ndegree = 3\nM = 40\nknots = range(0, tmax, M) |> collect;\nnothing #hide\n\nMake B-spline basis objects\n\nbasis = BSplineBasis(BSplineOrder(degree + 1), knots) # ; periodic=true\n\nPlot finely sampled B-spline basis functions\n\nBf = hcat([b.(tf) for b in basis]...)\npb1 = plot(tf, Bf; title=\"Basis functions, degree=$degree\")\n\nSample B-spline basis objects at measurement points\n\nB = hcat([b.(t) for b in basis]...)\npb2 = deepcopy(pb1)\nscatter!(pb2, t, B; title=\"Basis function samples\")","category":"section"},{"location":"generated/examples/01-spline/#LS-fit-of-B-splines-to-data","page":"Spline grid fitting","title":"LS fit of B-splines to data","text":"xh = B \\ y\nyhf = +([b.(tf) * xh[i] for (i,b) in enumerate(basis)]...);\nnothing #hide\n\nUtility functions for NRMSE\n\ndo_nrmse(yr::AbstractVector) = norm(yr - ytf) / norm(ytf)\nround3(x) = round(x, digits=3);\n\np1 = deepcopy(p0)\nplot!(p1, tf, yhf; label=\"bspline, NRMSE=$(round3(do_nrmse(yhf)))\")","category":"section"},{"location":"generated/examples/01-spline/#Tikhonov-regularization","page":"Spline grid fitting","title":"Tikhonov regularization","text":"Evidently the unregularized B-spline fit here is over-fitting, even though N  M, so next we try simple Tikhonov regularization.\n\nfunction do_fit(β::Real)\n    A = [B; sqrt(β)*I]\n    yz = [y; zeros(length(basis))]\n    xr = A \\ yz\n    yr = +([b.(tf) * xr[i] for (i,b) in enumerate(basis)]...)\nend\nnrmse_fit(β::Real) = do_nrmse(do_fit(β));\n\nβ = 2e-1\nyfr = do_fit(β);\n\np2 = deepcopy(p0)\nplot!(p2, tf, yfr,\n label = \"bspline β=$(round3(β)), NRMSE=$(round3(do_nrmse(yfr)))\")","category":"section"},{"location":"generated/examples/01-spline/#Parameter-tuning","page":"Spline grid fitting","title":"Parameter tuning","text":"What regularization parameter β to choose?\n\nCross-validation is one approach to choose.\n\nHere we use the simpler \"oracle\" approach of finding the β value that leads to the best fit to the true function (which would be unknown in practice).\n\nIt turns out here that Tikhonov regularization only slightly reduces NRMSE, even in this very favorable case where we use the ground-truth \"oracle\" to select β.\n\nApparently Tikhonov regularization is ineffective for (uniformly spaced) B-spline fitting to non-uniformly data.\n\nβlist = 10 .^ (-5:0.2:1)\nnrmse = nrmse_fit.(βlist)\nβbest = argmin(nrmse_fit, βlist)\npn = plot(log10.(βlist), 100*nrmse; title=\"NRMSE (%)\", xlabel=\"log10(β)\",\n yaxis = (\"NRMSE (%)\", (10, 30)),\n)\nplot!(log10(βbest) * [1, 1], [10, 40], color=:red)\n\nyfb = do_fit(βbest)\np3 = deepcopy(p0)\nnrmse_best = nrmse_fit(βbest)\nplot!(p3, tf, yfb,\n label=\"bspline β=$(round3(βbest)), NRMSE=$(round3(nrmse_best))\")","category":"section"},{"location":"generated/examples/01-spline/#Extensions","page":"Spline grid fitting","title":"Extensions","text":"2D image instead of 1D signal\ncomparison with implicit neural representation (INR)","category":"section"},{"location":"generated/examples/01-spline/#Reproducibility","page":"Spline grid fitting","title":"Reproducibility","text":"This page was generated with the following version of Julia:\n\nusing InteractiveUtils: versioninfo\nio = IOBuffer(); versioninfo(io); split(String(take!(io)), '\\n')\n\nAnd with the following package versions\n\nimport Pkg; Pkg.status()\n\n\n\nThis page was generated using Literate.jl.","category":"section"},{"location":"methods/#Methods-list","page":"-","title":"Methods list","text":"","category":"section"},{"location":"methods/#Methods-usage","page":"-","title":"Methods usage","text":"","category":"section"},{"location":"#Work.jl-Documentation","page":"Home","title":"Work.jl Documentation","text":"","category":"section"},{"location":"#Overview","page":"Home","title":"Overview","text":"This Julia package (Work)\n\nSee the \"Examples\" for details.","category":"section"}]
}
